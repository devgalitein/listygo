(h=>{h.fn.theiaStickySidebar=function(i){function t(i,t){return!0===i.initialized||!(h("body").width()<i.minWidth)&&(t=t,(b=i).initialized=!0,0===h("#theia-sticky-sidebar-stylesheet-"+b.namespace).length&&h("head").append(h('<style id="theia-sticky-sidebar-stylesheet-'+b.namespace+'">.theiaStickySidebar:after {content: ""; display: table; clear: both;}</style>')),t.each(function(){function p(){a.fixedScrollTop=0,a.sidebar.css({"min-height":"1px"}),a.stickySidebar.css({position:"static",width:"",transform:"none"})}var e,i,t,o,a={},s=(a.sidebar=h(this),a.options=b||{},a.container=h(a.options.containerSelector),0==a.container.length&&(a.container=a.sidebar.parent()),a.sidebar.parents().css("-webkit-transform","none"),a.sidebar.css({position:a.options.defaultPosition,overflow:"visible","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","box-sizing":"border-box"}),a.stickySidebar=a.sidebar.find(".theiaStickySidebar"),0==a.stickySidebar.length&&(e=/(?:text|application)\/(?:x-)?(?:javascript|ecmascript)/i,a.sidebar.find("script").filter(function(i,t){return 0===t.type.length||t.type.match(e)}).remove(),a.stickySidebar=h("<div>").addClass("theiaStickySidebar").append(a.sidebar.children()),a.sidebar.append(a.stickySidebar)),a.marginBottom=parseInt(a.sidebar.css("margin-bottom")),a.paddingTop=parseInt(a.sidebar.css("padding-top")),a.paddingBottom=parseInt(a.sidebar.css("padding-bottom")),a.stickySidebar.offset().top),n=a.stickySidebar.outerHeight();a.stickySidebar.css("padding-top",1),a.stickySidebar.css("padding-bottom",1),s-=a.stickySidebar.offset().top,n=a.stickySidebar.outerHeight()-n-s,0==s?(a.stickySidebar.css("padding-top",0),a.stickySidebarPaddingTop=0):a.stickySidebarPaddingTop=1,0==n?(a.stickySidebar.css("padding-bottom",0),a.stickySidebarPaddingBottom=0):a.stickySidebarPaddingBottom=1,a.previousScrollTop=null,a.fixedScrollTop=0,p(),a.onScroll=function(i){if(i.stickySidebar.is(":visible"))if(h("body").width()<i.options.minWidth)p();else{if(i.options.disableOnResponsiveLayouts)if(i.sidebar.outerWidth("none"==i.sidebar.css("float"))+50>i.container.width())return void p();var t,e,o,a,s,n=h(document).scrollTop(),d="static";n>=i.sidebar.offset().top+(i.paddingTop-i.options.additionalMarginTop)&&(e=i.paddingTop+b.additionalMarginTop,a=i.paddingBottom+i.marginBottom+b.additionalMarginBottom,s=i.sidebar.offset().top,r=i.sidebar.offset().top+(r=i.container,c=r.height(),r.children().each(function(){c=Math.max(c,h(this).height())}),c),t=0+b.additionalMarginTop,e=i.stickySidebar.outerHeight()+e+a<h(window).height()?t+i.stickySidebar.outerHeight():h(window).height()-i.marginBottom-i.paddingBottom-b.additionalMarginBottom,a=s-n+i.paddingTop,s=r-n-i.paddingBottom-i.marginBottom,r=i.stickySidebar.offset().top-n,o=i.previousScrollTop-n,"fixed"==i.stickySidebar.css("position")&&"modern"==i.options.sidebarBehavior&&(r+=o),"stick-to-top"==i.options.sidebarBehavior&&(r=b.additionalMarginTop),"stick-to-bottom"==i.options.sidebarBehavior&&(r=e-i.stickySidebar.outerHeight()),r=0<o?Math.min(r,t):Math.max(r,e-i.stickySidebar.outerHeight()),r=Math.max(r,a),r=Math.min(r,s-i.stickySidebar.outerHeight()),d=!(o=i.container.height()==i.stickySidebar.outerHeight())&&r==t||!o&&r==e-i.stickySidebar.outerHeight()?"fixed":n+r-i.sidebar.offset().top-i.paddingTop<=b.additionalMarginTop?"static":"absolute"),"fixed"==d?(a=h(document).scrollLeft(),i.stickySidebar.css({position:"fixed",width:l(i.stickySidebar)+"px",transform:"translateY("+r+"px)",left:i.sidebar.offset().left+parseInt(i.sidebar.css("padding-left"))-a+"px",top:"0px"})):"absolute"==d?(s={},"absolute"!=i.stickySidebar.css("position")&&(s.position="absolute",s.transform="translateY("+(n+r-i.sidebar.offset().top-i.stickySidebarPaddingTop-i.stickySidebarPaddingBottom)+"px)",s.top="0px"),s.width=l(i.stickySidebar)+"px",s.left="",i.stickySidebar.css(s)):"static"==d&&p(),"static"!=d&&1==i.options.updateSidebarHeight&&i.sidebar.css({"min-height":i.stickySidebar.outerHeight()+i.stickySidebar.offset().top-i.sidebar.offset().top+i.paddingBottom}),i.previousScrollTop=n}var r,c},a.onScroll(a),h(document).on("scroll."+a.options.namespace,(o=a,function(){o.onScroll(o)})),h(window).on("resize."+a.options.namespace,(t=a,function(){t.stickySidebar.css({position:"static"}),t.onScroll(t)})),"undefined"!=typeof ResizeSensor&&new ResizeSensor(a.stickySidebar[0],(i=a,function(){i.onScroll(i)}))}),!0);var b}function l(i){var t;try{t=i[0].getBoundingClientRect().width}catch(i){}return t=void 0===t?i.width():t}var e,o,a,s,n;return(i=h.extend({containerSelector:"",additionalMarginTop:0,additionalMarginBottom:0,updateSidebarHeight:!0,minWidth:0,disableOnResponsiveLayouts:!0,sidebarBehavior:"modern",defaultPosition:"relative",namespace:"TSS"},i)).additionalMarginTop=parseInt(i.additionalMarginTop)||0,i.additionalMarginBottom=parseInt(i.additionalMarginBottom)||0,t(i=i,e=this)||(console.log("TSS: Body width smaller than options.minWidth. Init is delayed."),h(document).on("scroll."+i.namespace,(s=i,n=e,function(i){t(s,n)&&h(this).unbind(i)})),h(window).on("resize."+i.namespace,(o=i,a=e,function(i){t(o,a)&&h(this).unbind(i)}))),this}})(jQuery);